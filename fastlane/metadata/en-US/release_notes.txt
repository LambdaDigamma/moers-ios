Minor improvements and better performance.
